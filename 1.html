<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <button>下载</button>
</body>

</html>
<!-- <script src="./tree.js"></script> -->
<script>
  function toTree (
    arr,
    pid = '#',
    idKey = 'id',
    pidKey = 'pid',
    childKey = 'children'
  ) {
    let root = arr.find((item) => item[idKey] == pid)
    let newArr = []
    arr.forEach((item) => {
      let parent = arr.find((i) => i[idKey] == item[pidKey])
      if (parent) {
        parent[childKey]
          ? parent[childKey].push(item)
          : (parent[childKey] = [item])
      } else {
        root
          ? root[childKey]
            ? root[childKey].push(item)
            : (root[childKey] = [item])
          : newArr.push(item)
      }
    })
    return root ? root : newArr
  }
  const toOne = (
    val,
    childrenKey = 'children',
    idKey = 'id',
    saveChild = false
  ) => {
    const arr2 = []
    let arr = null
    val instanceof Array ? (arr = val) : (arr = [val])
    arr.forEach((item) => {
      if (item[childrenKey]) {
        arr2.push(...toOne(item[childrenKey], childrenKey, idKey, saveChild))
      }
      const newItem = { ...item }
      saveChild
        ? arr2.push(newItem)
        : delete newItem[childrenKey] && arr2.push(newItem)
    })
    return arr2.sort((a, b) => {
      return a[idKey] - b[idKey]
    })
  }

  function clone (val) {
    function getType (target) {
      return Object.prototype.toString.call(target).slice(8, -1)
    }
    function cloneUtil (target) {
      let result
      if (getType(target) === 'Object') {
        result = {}
      } else if (getType(target) === 'Array') {
        result = []
      } else result = target
      for (let i in target) {
        let item = target[i]
        if (getType(item) === 'Object' || getType(item) === 'Array') {
          result[i] = cloneUtil(item)
        } else {
          result[i] = item
        }
      }
      return result
    }
    return cloneUtil(val)
  }
  let arr = [
    { id: 1 },
    { id: 2, pid: 1 },
    { id: 3 },
    { id: 4, pid: 1 },
    { id: 5 },
    { id: 6, pid: 2 },

  ]
  // const arr2 = toTree(arr)
  // console.log(arr2);
  // console.log(toOne(arr2));
  // const arr3 = clone(arr)
  // arr3.push({ id: 7 })
  // console.log(arr3, arr);
  const obj = {id:1,name:'张飞'}
  const obj2 =clone(obj)
  obj2.name= '关羽'
  console.log(obj,obj2);
</script>